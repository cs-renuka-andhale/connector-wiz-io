{
  "name": "wiz-io",
  "version": "1.0.0",
  "label": "Wiz.io",
  "description": "Wiz provides a comprehensive analysis engine that integrates: Cloud Security Posture Management (CSPM) Kubernetes Security Posture Management (KSPM) Cloud Workload Protection (CWPP) + vulnerability management. Infrastructure-as-Code (IaC) scanning.",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "category": [
        "Asset Management",
        "Attack surface management",
        "Cloud Security"
    ],
  "help_online": "https://github.com/fortinet-fortisoar/connector-wiz-io/blob/release/1.0.0/docs/wiz-io.md",
  "configuration": {
    "fields": [
      {
        "title": "API Endpoint URL",
        "type": "url",
        "name": "aPIEndpointURL",
        "required": true,
        "visible": true,
        "editable": true,
        "value": "https://api.us1.app.wiz.io",
        "tooltip": "Provide the API endpoint URL for the GraphQL API. The format is as follow: https://api.<location>.app.wiz.io\nThe \"location\" value and the URL can be retrieved from the WIZ tenant settings.",
        "description": "Specify the URL of the Wiz.io server to connect and perform automated operations. Provide the API endpoint URL for the GraphQL API. The format is as follow: https://api.<location>.app.wiz.io"
      },
      {
        "title": "Client ID",
        "type": "text",
        "name": "clientID",
        "required": true,
        "visible": true,
        "editable": true,
        "value": "",
        "tooltip": "Provide the API Client ID generated in the service account of the WIZ deployment.",
        "description": "Specify the API Client ID generated in the service account of the WIZ deployment to access the Wiz.io server to connect and perform the automated operations."
      },
      {
        "title": "Client Secret",
        "type": "password",
        "name": "clientSecret",
        "required": true,
        "visible": true,
        "editable": true,
        "value": null,
        "tooltip": "Provide the API Client Secret generated in the service account of the WIZ deployment.",
        "description": "Specify the API Client Secret generated in the service account of the WIZ deployment to access the Wiz.io server to connect and perform the automated operations."
      },
      {
        "title": "Authentication Endpoint URL",
        "type": "url",
        "name": "authenticationEndpointURL",
        "required": false,
        "visible": true,
        "editable": true,
        "value": "https://auth.app.wiz.io/oauth/token",
        "tooltip": "URL which is used to retrieve OAuth Token from. The URL can be found at the Service Account page.",
        "description": "Specify the URL which is used to retrieve OAuth Token from. The URL can be found at the Service Account page to access the Wiz.io server to connect and perform the automated operations."
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True.",
        "tooltip": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "title": "Get Issues",
      "operation": "get_issues",
      "description": "Get Issues for all Assets from Wiz.io",
      "parameters": [
        {
          "title": "Filter Query",
          "type": "object",
          "name": "filterQuery",
          "required": true,
          "visible": true,
          "editable": true,
          "value": null,
          "tooltip": "Using json syntax to define a query for the results.",
          "description": "Specify the filter query to fetch the issues from Wiz."
        },
        {
          "title": "Limit",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 100,
          "tooltip": "Limit the results by the amount provided. Will automatically enable pagination.",
          "description": "Specify the maximum number of issues to be returned in response."
        }
      ],
      "open": false
    },
    {
      "title": "Get Inventory Assets",
      "operation": "get_inventory_assets",
      "description": "Get Inventory Assets from Wiz.io platform.",
      "parameters": [
        {
          "title": "Project ID",
          "type": "text",
          "name": "projectID",
          "required": false,
          "visible": true,
          "editable": true,
          "value": "*",
          "tooltip": "Provide a project id from which the assets should be gathered. Keep the wildcard to allow all projects to be included.",
          "description": "Specify the project ID for which the inventory assets will be returned."
        },
        {
          "title": "Filter Query",
          "type": "object",
          "name": "filterQuery",
          "required": false,
          "visible": true,
          "editable": true,
          "value": null,
          "tooltip": "Provide a Query which filters for the necessary asset like a VM on AWS, etc.",
          "description": "Specify the filter query to fetch the inventory assets from Wiz."
        },
        {
          "title": "Limit",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 10,
          "tooltip": "Limit the results by the amount provided. Will automatically enable pagination.",
          "description": "Specify the maximum number of inventory assets to be returned in response."
        }
      ],
      "open": false
    },
    {
      "title": "Get Issues by Asset",
      "operation": "get_issues_by_asset",
      "description": "Get Issues for all Assets from Wiz.io and allows to filter for a specific Asset, Project and Status.",
      "parameters": [
        {
          "title": "Asset ID",
          "type": "text",
          "name": "assetID",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "",
          "tooltip": "Provide the ID of an Asset Issues should retrieved for.",
          "description": "Specify the asset ID for which the issues will be returned."
        },
        {
          "title": "Project ID",
          "type": "text",
          "name": "projectID",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "",
          "tooltip": "Filter for specific Assets and Issues within a Project.",
          "description": "Specify the project ID for which the issues will be returned."
        },
        {
          "title": "Status",
          "type": "text",
          "name": "status",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "[\"OPEN\",\"IN_PROGRESS\"]",
          "tooltip": "Provide a list of issue status. Possible values are allowed: OPEN, RESOLVED, IN_PROGRESS & REJECTED.",
          "description": "Specify the issue status, values are OPEN, RESOLVED, IN_PROGRESS & REJECTED."
        },
        {
          "title": "Limit",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 10,
          "tooltip": "Limit the results by the amount provided. Will automatically enable pagination.",
          "description": "Specify the maximum number of issues to be returned in response."
        }
      ],
      "open": false
    },
    {
      "title": "Get Projects",
      "operation": "get_projects",
      "description": "Get a list of projects and settings of the projects.",
      "parameters": [
        {
          "title": "Limit",
          "type": "integer",
          "name": "limit",
          "required": false,
          "visible": true,
          "editable": true,
          "value": 20,
          "tooltip": "Limit the results by the amount provided. Will automatically enable pagination.",
          "description": "Specify the maximum number of projects to be returned in response."
        }
      ],
      "open": false
    },
    {
      "title": "Add Comment to Issue",
      "operation": "add_comment_to_issue",
      "description": "Add a comment to an existing issue within Wiz.io",
      "parameters": [
        {
          "title": "Issue ID",
          "type": "text",
          "name": "issueID",
          "required": true,
          "visible": true,
          "editable": true,
          "value": "",
          "tooltip": "ID of the issue where a comment should be added.",
          "description": "Specify the ID of the issue for which the comment should be added."
        },
        {
          "title": "Comment",
          "type": "textarea",
          "name": "comment",
          "required": true,
          "visible": true,
          "editable": true,
          "value": null,
          "tooltip": "Comment message to add to a issue.",
          "description": "Specify the comment message to add to issue."
        }
      ],
      "open": false
    }
  ]
}